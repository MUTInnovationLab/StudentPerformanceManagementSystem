<!-- profile.component.html -->
<ion-content>
  <div class="profile-header ion-padding">
    <div class="header-content" *ngIf="userProfile$ | async as user">
      <div class="user-avatar">
        <ion-avatar>
          <img [src]="user.photoURL || defaultAvatarUrl" alt="Profile photo">
        </ion-avatar>
        <ion-button fill="clear" size="small" class="edit-avatar-btn" (click)="updateProfilePhoto()">
          <ion-icon name="camera-outline"></ion-icon>
        </ion-button>
      </div>
      <h1 class="user-name">{{ user.fullName || 'Update Your Profile' }}</h1>
      <p class="user-position">{{ user.position || 'Position not set' }}</p>
    </div>
  </div>

  <div class="profile-content ion-padding">
    <div class="info-section" *ngIf="userProfile$ | async as user">
      <h2 class="section-title">Profile Information</h2>
      <ion-list lines="full">
        <ion-item>
          <ion-icon name="person-outline" slot="start" color="primary"></ion-icon>
          <ion-label>
            <p class="label-text">Full Name</p>
            <h3>{{ user.fullName || 'Not set' }}</h3>
          </ion-label>
        </ion-item>

        <ion-item>
          <ion-icon name="mail-outline" slot="start" color="primary"></ion-icon>
          <ion-label>
            <p class="label-text">Email</p>
            <h3>{{ user.email || 'No email available' }}</h3>
          </ion-label>
        </ion-item>

        <ion-item>
          <ion-icon name="business-outline" slot="start" color="primary"></ion-icon>
          <ion-label>
            <p class="label-text">Position</p>
            <h3>{{ user.position || 'Not set' }}</h3>
          </ion-label>
        </ion-item>

        <ion-item>
          <ion-icon name="id-card-outline" slot="start" color="primary"></ion-icon>
          <ion-label>
            <p class="label-text">Staff Number</p>
            <h3>{{ user.staffNumber || 'Not set' }}</h3>
          </ion-label>
        </ion-item>
      </ion-list>

      <div *ngIf="!user.fullName || !user.position || !user.staffNumber" class="incomplete-profile-warning">
        <ion-note color="warning">
          <ion-icon name="warning-outline"></ion-icon>
          Please complete your profile information
        </ion-note>
      </div>
    </div>

    <div class="actions-section">
      <h2 class="section-title">Account Settings</h2>
      <ion-list lines="full">
        <ion-item button (click)="editProfile()" detail="true">
          <ion-icon name="create-outline" slot="start" color="primary"></ion-icon>
          <ion-label>
            <h3>Edit Profile</h3>
            <p>Update your profile information</p>
          </ion-label>
        </ion-item>

        <ion-item button (click)="changePassword()" detail="true">
          <ion-icon name="key-outline" slot="start" color="primary"></ion-icon>
          <ion-label>
            <h3>Change Password</h3>
            <p>Update your password</p>
          </ion-label>
        </ion-item>

        <ion-item button (click)="logout()" detail="true" lines="none">
          <ion-icon name="log-out-outline" slot="start" color="danger"></ion-icon>
          <ion-label color="danger">
            <h3>Logout</h3>
            <p>Sign out of your account</p>
          </ion-label>
        </ion-item>
      </ion-list>
    </div>
  </div>
</ion-content>